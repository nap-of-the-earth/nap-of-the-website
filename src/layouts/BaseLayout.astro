---
import BaseHead from "@components/astro/BaseHead.astro";
import Footer from "@components/astro/Footer.astro";
import Navbar from "@components/react/Navbar";
import ChatWidget from "@components/react/ChatWidget";
import "@/styles/global.css";

interface Props {
  title: string;
  description?: string;
  ogImage?: string;
}

const { title, description, ogImage } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={title} description={description} ogImage={ogImage} />
  </head>
  <body>
    <!-- Gradient Mesh Background -->
    <div class="mesh-bg" aria-hidden="true">
      <div class="mesh-orb mesh-orb-1"></div>
      <div class="mesh-orb mesh-orb-2"></div>
      <div class="mesh-orb mesh-orb-3"></div>
    </div>

    <Navbar client:load />
    <main>
      <slot />
    </main>
    <Footer />
    <ChatWidget client:idle />
    <script is:inline>
      (function() {
        function setupReveal() {
          var els = document.querySelectorAll(".reveal");
          if (els.length === 0) return;

          if (!("IntersectionObserver" in window)) {
            els.forEach(function(el) { el.classList.add("visible"); });
            return;
          }

          var observer = new IntersectionObserver(function(entries) {
            for (var i = 0; i < entries.length; i++) {
              if (entries[i].isIntersecting) {
                entries[i].target.classList.add("visible");
                observer.unobserve(entries[i].target);
              }
            }
          }, { threshold: 0.05 });

          for (var i = 0; i < els.length; i++) {
            observer.observe(els[i]);
          }
        }

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", setupReveal);
        } else {
          setupReveal();
        }
      })();
    </script>
  </body>
</html>
